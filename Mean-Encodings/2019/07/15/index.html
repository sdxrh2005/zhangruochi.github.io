<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PingFang SC:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zhangruochi.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="For different types of Mean Encodings">
<meta property="og:type" content="article">
<meta property="og:title" content="Mean Encodings">
<meta property="og:url" content="https://zhangruochi.com/Mean-Encodings/2019/07/15/index.html">
<meta property="og:site_name" content="RUOCHI.AI">
<meta property="og:description" content="For different types of Mean Encodings">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-07-14T19:48:29.000Z">
<meta property="article:modified_time" content="2020-01-09T06:32:50.374Z">
<meta property="article:author" content="Ruochi Zhang">
<meta property="article:tag" content="Feature Engineering">
<meta property="article:tag" content="Project">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://zhangruochi.com/Mean-Encodings/2019/07/15/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Mean Encodings | RUOCHI.AI</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">RUOCHI.AI</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://zhangruochi.com/Mean-Encodings/2019/07/15/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruochi Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RUOCHI.AI">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Mean Encodings
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-07-15 03:48:29" itemprop="dateCreated datePublished" datetime="2019-07-15T03:48:29+08:00">2019-07-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-01-09 14:32:50" itemprop="dateModified" datetime="2020-01-09T14:32:50+08:00">2020-01-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Artificial-Intelligence/" itemprop="url" rel="index"><span itemprop="name">Artificial Intelligence</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Artificial-Intelligence/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Artificial-Intelligence/Data-Mining/" itemprop="url" rel="index"><span itemprop="name">Data Mining</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/Mean-Encodings/2019/07/15/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/Mean-Encodings/2019/07/15/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <div class="post-description">For different types of Mean Encodings</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Version 1.1.0</p>
<h1 id="mean-encodings">Mean encodings</h1>
<p>In this programming assignment you will be working with <code>1C</code> dataset from the final competition. You are asked to encode <code>item_id</code> in 4 different ways:</p>
<pre><code>1) Via KFold scheme;  
2) Via Leave-one-out scheme;
3) Via smoothing scheme;
4) Via expanding mean scheme.</code></pre>
<p><strong>You will need to submit</strong> the correlation coefficient between resulting encoding and target variable up to 4 decimal places.</p>
<h3 id="general-tips">General tips</h3>
<ul>
<li>Fill NANs in the encoding with <code>0.3343</code>.</li>
<li>Some encoding schemes depend on sorting order, so in order to avoid confusion, please use the following code snippet to construct the data frame. This snippet also implements mean encoding without regularization.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> grader <span class="keyword">import</span> Grader</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>(product(<span class="string">&#x27;ABCD&#x27;</span>, <span class="string">&#x27;xy&#x27;</span>))</span><br></pre></td></tr></table></figure>
<pre><code>[(&#39;A&#39;, &#39;x&#39;),
 (&#39;A&#39;, &#39;y&#39;),
 (&#39;B&#39;, &#39;x&#39;),
 (&#39;B&#39;, &#39;y&#39;),
 (&#39;C&#39;, &#39;x&#39;),
 (&#39;C&#39;, &#39;y&#39;),
 (&#39;D&#39;, &#39;x&#39;),
 (&#39;D&#39;, &#39;y&#39;)]</code></pre>
<h1 id="read-data">Read data</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales = pd.read_csv(<span class="string">&#x27;../readonly/final_project_data/sales_train.csv.gz&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales.head(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
date
</th>
<th>
date_block_num
</th>
<th>
shop_id
</th>
<th>
item_id
</th>
<th>
item_price
</th>
<th>
item_cnt_day
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
02.01.2013
</td>
<td>
0
</td>
<td>
59
</td>
<td>
22154
</td>
<td>
999.00
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
1
</th>
<td>
03.01.2013
</td>
<td>
0
</td>
<td>
25
</td>
<td>
2552
</td>
<td>
899.00
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
2
</th>
<td>
05.01.2013
</td>
<td>
0
</td>
<td>
25
</td>
<td>
2552
</td>
<td>
899.00
</td>
<td>
-1.0
</td>
</tr>
<tr>
<th>
3
</th>
<td>
06.01.2013
</td>
<td>
0
</td>
<td>
25
</td>
<td>
2554
</td>
<td>
1709.05
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
4
</th>
<td>
15.01.2013
</td>
<td>
0
</td>
<td>
25
</td>
<td>
2555
</td>
<td>
1099.00
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
5
</th>
<td>
10.01.2013
</td>
<td>
0
</td>
<td>
25
</td>
<td>
2564
</td>
<td>
349.00
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
6
</th>
<td>
02.01.2013
</td>
<td>
0
</td>
<td>
25
</td>
<td>
2565
</td>
<td>
549.00
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
7
</th>
<td>
04.01.2013
</td>
<td>
0
</td>
<td>
25
</td>
<td>
2572
</td>
<td>
239.00
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
8
</th>
<td>
11.01.2013
</td>
<td>
0
</td>
<td>
25
</td>
<td>
2572
</td>
<td>
299.00
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
9
</th>
<td>
03.01.2013
</td>
<td>
0
</td>
<td>
25
</td>
<td>
2573
</td>
<td>
299.00
</td>
<td>
3.0
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales.nunique()</span><br></pre></td></tr></table></figure>
<pre><code>date               1034
date_block_num       34
shop_id              60
item_id           21807
item_price        19993
item_cnt_day        198
dtype: int64</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales[<span class="string">&quot;date_block_num&quot;</span>].unique()</span><br></pre></td></tr></table></figure>
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33])</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales[sales[<span class="string">&quot;date_block_num&quot;</span>] ==<span class="number">1</span>].head()</span><br></pre></td></tr></table></figure>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
date
</th>
<th>
date_block_num
</th>
<th>
shop_id
</th>
<th>
item_id
</th>
<th>
item_price
</th>
<th>
item_cnt_day
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
115690
</th>
<td>
21.02.2013
</td>
<td>
1
</td>
<td>
50
</td>
<td>
3880
</td>
<td>
1499.0
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
115691
</th>
<td>
14.02.2013
</td>
<td>
1
</td>
<td>
50
</td>
<td>
3880
</td>
<td>
1499.0
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
115692
</th>
<td>
21.02.2013
</td>
<td>
1
</td>
<td>
50
</td>
<td>
4128
</td>
<td>
899.0
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
115693
</th>
<td>
13.02.2013
</td>
<td>
1
</td>
<td>
50
</td>
<td>
4124
</td>
<td>
249.0
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
115694
</th>
<td>
24.02.2013
</td>
<td>
1
</td>
<td>
50
</td>
<td>
3880
</td>
<td>
1499.0
</td>
<td>
1.0
</td>
</tr>
</tbody>
</table>
</div>
<h1 id="aggregate-data">Aggregate data</h1>
<p>Since the competition task is to make a <strong>monthly prediction</strong>, we need to aggregate the data to montly level before doing any encodings. The following code-cell serves just that purpose.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">index_cols = [<span class="string">&#x27;shop_id&#x27;</span>, <span class="string">&#x27;item_id&#x27;</span>, <span class="string">&#x27;date_block_num&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># For every month we create a grid from all shops/items combinations from that month</span></span><br><span class="line">grid = [] </span><br><span class="line"><span class="keyword">for</span> block_num <span class="keyword">in</span> sales[<span class="string">&#x27;date_block_num&#x27;</span>].unique():</span><br><span class="line">    cur_shops = sales[sales[<span class="string">&#x27;date_block_num&#x27;</span>]==block_num][<span class="string">&#x27;shop_id&#x27;</span>].unique()</span><br><span class="line">    cur_items = sales[sales[<span class="string">&#x27;date_block_num&#x27;</span>]==block_num][<span class="string">&#x27;item_id&#x27;</span>].unique()</span><br><span class="line">    grid.append(np.array(<span class="built_in">list</span>(product(*[cur_shops, cur_items, [block_num]])),dtype=<span class="string">&#x27;int32&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#turn the grid into pandas dataframe</span></span><br><span class="line">grid = pd.DataFrame(np.vstack(grid), columns = index_cols,dtype=np.int32)</span><br><span class="line"></span><br><span class="line"><span class="comment">#get aggregated values for (shop_id, item_id, month)</span></span><br><span class="line">gb = sales.groupby(index_cols,as_index=<span class="literal">False</span>).agg(&#123;<span class="string">&#x27;item_cnt_day&#x27;</span>:&#123;<span class="string">&#x27;target&#x27;</span>:<span class="string">&#x27;sum&#x27;</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#fix column names</span></span><br><span class="line">gb.columns = [col[<span class="number">0</span>] <span class="keyword">if</span> col[-<span class="number">1</span>]==<span class="string">&#x27;&#x27;</span> <span class="keyword">else</span> col[-<span class="number">1</span>] <span class="keyword">for</span> col <span class="keyword">in</span> gb.columns.values]</span><br><span class="line"><span class="comment">#join aggregated data to the grid</span></span><br><span class="line">all_data = pd.merge(grid,gb,how=<span class="string">&#x27;left&#x27;</span>,on=index_cols).fillna(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#sort the data</span></span><br><span class="line">all_data.sort_values([<span class="string">&#x27;date_block_num&#x27;</span>,<span class="string">&#x27;shop_id&#x27;</span>,<span class="string">&#x27;item_id&#x27;</span>],inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>/opt/conda/lib/python3.6/site-packages/pandas/core/groupby.py:4036: FutureWarning: using a dict with renaming is deprecated and will be removed in a future version
  return super(DataFrameGroupBy, self).aggregate(arg, *args, **kwargs)</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">all_data.head(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
shop_id
</th>
<th>
item_id
</th>
<th>
date_block_num
</th>
<th>
target
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
139255
</th>
<td>
0
</td>
<td>
19
</td>
<td>
0
</td>
<td>
0.0
</td>
</tr>
<tr>
<th>
141495
</th>
<td>
0
</td>
<td>
27
</td>
<td>
0
</td>
<td>
0.0
</td>
</tr>
<tr>
<th>
144968
</th>
<td>
0
</td>
<td>
28
</td>
<td>
0
</td>
<td>
0.0
</td>
</tr>
<tr>
<th>
142661
</th>
<td>
0
</td>
<td>
29
</td>
<td>
0
</td>
<td>
0.0
</td>
</tr>
<tr>
<th>
138947
</th>
<td>
0
</td>
<td>
32
</td>
<td>
0
</td>
<td>
6.0
</td>
</tr>
<tr>
<th>
138948
</th>
<td>
0
</td>
<td>
33
</td>
<td>
0
</td>
<td>
3.0
</td>
</tr>
<tr>
<th>
138949
</th>
<td>
0
</td>
<td>
34
</td>
<td>
0
</td>
<td>
0.0
</td>
</tr>
<tr>
<th>
139247
</th>
<td>
0
</td>
<td>
35
</td>
<td>
0
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
142672
</th>
<td>
0
</td>
<td>
40
</td>
<td>
0
</td>
<td>
0.0
</td>
</tr>
<tr>
<th>
142065
</th>
<td>
0
</td>
<td>
41
</td>
<td>
0
</td>
<td>
0.0
</td>
</tr>
</tbody>
</table>
</div>
<h1 id="mean-encodings-without-regularization">Mean encodings without regularization</h1>
<p>After we did the techinical work, we are ready to actually <em>mean encode</em> the desired <code>item_id</code> variable.</p>
<p>Here are two ways to implement mean encoding features <em>without</em> any regularization. You can use this code as a starting point to implement regularized techniques.</p>
<h4 id="method-1">Method 1</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Calculate a mapping: &#123;item_id: target_mean&#125;</span></span><br><span class="line">item_id_target_mean = all_data.groupby(<span class="string">&#x27;item_id&#x27;</span>).target.mean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># In our non-regularized case we just *map* the computed means to the `item_id`&#x27;s</span></span><br><span class="line">all_data[<span class="string">&#x27;item_target_enc&#x27;</span>] = all_data[<span class="string">&#x27;item_id&#x27;</span>].<span class="built_in">map</span>(item_id_target_mean)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fill NaNs</span></span><br><span class="line">all_data[<span class="string">&#x27;item_target_enc&#x27;</span>].fillna(<span class="number">0.3343</span>, inplace=<span class="literal">True</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># Print correlation</span></span><br><span class="line">encoded_feature = all_data[<span class="string">&#x27;item_target_enc&#x27;</span>].values</span><br><span class="line"><span class="built_in">print</span>(np.corrcoef(all_data[<span class="string">&#x27;target&#x27;</span>].values, encoded_feature)[<span class="number">0</span>][<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<pre><code>0.483038698862</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">all_data[all_data[<span class="string">&quot;item_id&quot;</span>] == <span class="number">19</span>].head()</span><br></pre></td></tr></table></figure>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
shop_id
</th>
<th>
item_id
</th>
<th>
date_block_num
</th>
<th>
target
</th>
<th>
item_target_enc
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
139255
</th>
<td>
0
</td>
<td>
19
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0.022222
</td>
</tr>
<tr>
<th>
147370
</th>
<td>
1
</td>
<td>
19
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0.022222
</td>
</tr>
<tr>
<th>
114910
</th>
<td>
2
</td>
<td>
19
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0.022222
</td>
</tr>
<tr>
<th>
123025
</th>
<td>
3
</td>
<td>
19
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0.022222
</td>
</tr>
<tr>
<th>
98680
</th>
<td>
4
</td>
<td>
19
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0.022222
</td>
</tr>
</tbody>
</table>
</div>
<h4 id="method-2">Method 2</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">     Differently to `.target.mean()` function `transform` </span></span><br><span class="line"><span class="string">   will return a dataframe with an index like in `all_data`.</span></span><br><span class="line"><span class="string">   Basically this single line of code is equivalent to the first two lines from of Method 1.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">all_data[<span class="string">&#x27;item_target_enc&#x27;</span>] = all_data.groupby(<span class="string">&#x27;item_id&#x27;</span>)[<span class="string">&#x27;target&#x27;</span>].transform(<span class="string">&#x27;mean&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fill NaNs</span></span><br><span class="line">all_data[<span class="string">&#x27;item_target_enc&#x27;</span>].fillna(<span class="number">0.3343</span>, inplace=<span class="literal">True</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># Print correlation</span></span><br><span class="line">encoded_feature = all_data[<span class="string">&#x27;item_target_enc&#x27;</span>].values</span><br><span class="line"><span class="built_in">print</span>(np.corrcoef(all_data[<span class="string">&#x27;target&#x27;</span>].values, encoded_feature)[<span class="number">0</span>][<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<pre><code>0.483038698862</code></pre>
<p>See the printed value? It is the correlation coefficient between the target variable and your new encoded feature. You need to <strong>compute correlation coefficient</strong> between the encodings, that you will implement and <strong>submit those to coursera</strong>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grader = Grader()</span><br></pre></td></tr></table></figure>
<h1 id="kfold-scheme">1. KFold scheme</h1>
<p>Explained starting at 41 sec of <a target="_blank" rel="noopener" href="https://www.coursera.org/learn/competitive-data-science/lecture/LGYQ2/regularization">Regularization video</a>.</p>
<p><strong>Now it's your turn to write the code!</strong></p>
<p>You may use 'Regularization' video as a reference for all further tasks.</p>
<p>First, implement KFold scheme with five folds. Use KFold(5) from sklearn.model_selection.</p>
<ol type="1">
<li><p>Split your data in 5 folds with <code>sklearn.model_selection.KFold</code> with <code>shuffle=False</code> argument.</p></li>
<li><p>Iterate through folds: use all but the current fold to calculate mean target for each level <code>item_id</code>, and fill the current fold.</p>
<ul>
<li>See the <strong>Method 1</strong> from the example implementation. In particular learn what <code>map</code> and pd.Series.map functions do. They are pretty handy in many situations.</li>
</ul></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># YOUR CODE GOES HERE</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> KFold</span><br><span class="line">kf = KFold(shuffle=<span class="literal">False</span>, n_splits = <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> train_index, test_index <span class="keyword">in</span> kf.split(all_data):</span><br><span class="line">    x_tr = all_data.iloc[train_index]</span><br><span class="line">    mean = x_tr.groupby(<span class="string">&quot;item_id&quot;</span>).target.mean()</span><br><span class="line">    all_data.loc[all_data.index[test_index],<span class="string">&#x27;item_target_enc&#x27;</span>] = all_data.loc[all_data.index[test_index],<span class="string">&#x27;item_id&#x27;</span>].<span class="built_in">map</span>(mean)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">all_data[<span class="string">&#x27;item_target_enc&#x27;</span>].fillna(<span class="number">0.3343</span>, inplace=<span class="literal">True</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">## fill with global mean </span></span><br><span class="line"><span class="comment">#all_data[&#x27;item_target_enc&#x27;].fillna(all_data[&#x27;target&#x27;].mean(), inplace = True)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You will need to compute correlation like that</span></span><br><span class="line">corr = np.corrcoef(all_data[<span class="string">&#x27;target&#x27;</span>].values, encoded_feature)[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(corr)</span><br><span class="line">grader.submit_tag(<span class="string">&#x27;KFold_scheme&#x27;</span>, corr)</span><br></pre></td></tr></table></figure>
<pre><code>0.41645907128
Current answer for task KFold_scheme is: 0.41645907128</code></pre>
<h1 id="leave-one-out-scheme">2. Leave-one-out scheme</h1>
<p>Now, implement leave-one-out scheme. Note that if you just simply set the number of folds to the number of samples and run the code from the <strong>KFold scheme</strong>, you will probably wait for a very long time.</p>
<p>To implement a faster version, note, that to calculate mean target value using all the objects but one <em>given object</em>, you can:</p>
<ol type="1">
<li>Calculate sum of the target values using all the objects.</li>
<li>Then subtract the target of the <em>given object</em> and divide the resulting value by <code>n_objects - 1</code>.</li>
</ol>
<p>Note that you do not need to perform <code>1.</code> for every object. And <code>2.</code> can be implemented without any <code>for</code> loop.</p>
<p>It is the most convenient to use <code>.transform</code> function as in <strong>Method 2</strong>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># YOUR CODE GOES HERE</span></span><br><span class="line">totalSum = all_data[<span class="string">&#x27;item_id&#x27;</span>].<span class="built_in">map</span>(all_data.groupby(<span class="string">&#x27;item_id&#x27;</span>)[<span class="string">&#x27;target&#x27;</span>].<span class="built_in">sum</span>())</span><br><span class="line">n_objects = all_data[<span class="string">&#x27;item_id&#x27;</span>].<span class="built_in">map</span>(all_data.groupby(<span class="string">&#x27;item_id&#x27;</span>)[<span class="string">&#x27;target&#x27;</span>].count())</span><br><span class="line">all_data[<span class="string">&#x27;item_target_enc&#x27;</span>] = (totalSum - all_data[<span class="string">&#x27;target&#x27;</span>]) / (n_objects - <span class="number">1</span>)</span><br><span class="line">encoded_feature = all_data[<span class="string">&#x27;item_target_enc&#x27;</span>].values</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">corr = np.corrcoef(all_data[<span class="string">&#x27;target&#x27;</span>].values, encoded_feature)[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(corr)</span><br><span class="line">grader.submit_tag(<span class="string">&#x27;Leave-one-out_scheme&#x27;</span>, corr)</span><br></pre></td></tr></table></figure>
<pre><code>0.480384831129
Current answer for task Leave-one-out_scheme is: 0.480384831129</code></pre>
<h1 id="smoothing">3. Smoothing</h1>
<p>Explained starting at 4:03 of <a target="_blank" rel="noopener" href="https://www.coursera.org/learn/competitive-data-science/lecture/LGYQ2/regularization">Regularization video</a>.</p>
<p>Next, implement smoothing scheme with <span class="math inline">\(\alpha = 100\)</span>. Use the formula from the first slide in the video and <span class="math inline">\(0.3343\)</span> as <code>globalmean</code>. Note that <code>nrows</code> is the number of objects that belong to a certain category (not the number of rows in the dataset).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># YOUR CODE GOES HERE</span></span><br><span class="line">alpha = <span class="number">100</span></span><br><span class="line">globalmean = <span class="number">0.3343</span></span><br><span class="line">nrows = all_data.groupby(<span class="string">&#x27;item_id&#x27;</span>)[<span class="string">&#x27;target&#x27;</span>].count()</span><br><span class="line">targetmean = all_data.groupby(<span class="string">&#x27;item_id&#x27;</span>)[<span class="string">&#x27;target&#x27;</span>].mean()</span><br><span class="line">smooth = (targetmean*nrows + globalmean*alpha) / (nrows + alpha)</span><br><span class="line">all_data[<span class="string">&#x27;item_target_enc&#x27;</span>] = all_data[<span class="string">&#x27;item_id&#x27;</span>].<span class="built_in">map</span>(smooth)</span><br><span class="line">encoded_feature = all_data[<span class="string">&#x27;item_target_enc&#x27;</span>].values</span><br><span class="line"></span><br><span class="line">corr = np.corrcoef(all_data[<span class="string">&#x27;target&#x27;</span>].values, encoded_feature)[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(corr)</span><br><span class="line">grader.submit_tag(<span class="string">&#x27;Smoothing_scheme&#x27;</span>, corr)</span><br></pre></td></tr></table></figure>
<pre><code>0.48181987971
Current answer for task Smoothing_scheme is: 0.48181987971</code></pre>
<h1 id="expanding-mean-scheme">4. Expanding mean scheme</h1>
<p>Explained starting at 5:50 of <a target="_blank" rel="noopener" href="https://www.coursera.org/learn/competitive-data-science/lecture/LGYQ2/regularization">Regularization video</a>.</p>
<p>Finally, implement the <em>expanding mean</em> scheme. It is basically already implemented for you in the video, but you can challenge yourself and try to implement it yourself. You will need <a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.core.groupby.DataFrameGroupBy.cumsum.html"><code>cumsum</code></a> and <a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.core.groupby.GroupBy.cumcount.html"><code>cumcount</code></a> functions from pandas.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># YOUR CODE GOES HERE</span></span><br><span class="line">cumsum = all_data.groupby(<span class="string">&#x27;item_id&#x27;</span>)[<span class="string">&#x27;target&#x27;</span>].cumsum() - all_data[<span class="string">&#x27;target&#x27;</span>]</span><br><span class="line">cumcnt = all_data.groupby(<span class="string">&#x27;item_id&#x27;</span>).cumcount()</span><br><span class="line"></span><br><span class="line">all_data[<span class="string">&#x27;item_target_enc&#x27;</span>] = cumsum/cumcnt</span><br><span class="line">all_data[<span class="string">&#x27;item_target_enc&#x27;</span>].fillna(<span class="number">0.3343</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">encoded_feature = all_data[<span class="string">&#x27;item_target_enc&#x27;</span>].values</span><br><span class="line"></span><br><span class="line">corr = np.corrcoef(all_data[<span class="string">&#x27;target&#x27;</span>].values, encoded_feature)[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(corr)</span><br><span class="line">grader.submit_tag(<span class="string">&#x27;Expanding_mean_scheme&#x27;</span>, corr)</span><br></pre></td></tr></table></figure>
<pre><code>0.502524521108
Current answer for task Expanding_mean_scheme is: 0.502524521108</code></pre>
<h2 id="authorization-submission">Authorization &amp; Submission</h2>
<p>To submit assignment parts to Cousera platform, please, enter your e-mail and token into variables below. You can generate token on this programming assignment page. Note: Token expires 30 minutes after generation.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">STUDENT_EMAIL = <span class="string">&quot;lvduzhen@gmail.com&quot;</span></span><br><span class="line">STUDENT_TOKEN =<span class="string">&quot;8sHsHAXqlUWuMlfo&quot;</span></span><br><span class="line">grader.status()</span><br></pre></td></tr></table></figure>
<pre><code>You want to submit these numbers:
Task KFold_scheme: 0.41645907128
Task Leave-one-out_scheme: 0.480384831129
Task Smoothing_scheme: 0.48181987971
Task Expanding_mean_scheme: 0.502524521108</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grader.submit(STUDENT_EMAIL, STUDENT_TOKEN)</span><br></pre></td></tr></table></figure>
<pre><code>Submitted to Coursera platform. See results on assignment page!</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Feature-Engineering/" rel="tag"># Feature Engineering</a>
              <a href="/tags/Project/" rel="tag"># Project</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/Metrics/2019/07/14/" rel="prev" title="Metrics">
      <i class="fa fa-chevron-left"></i> Metrics
    </a></div>
      <div class="post-nav-item">
    <a href="/Hyperparameters-tuning/2019/07/16/" rel="next" title="Hyperparameters tuning">
      Hyperparameters tuning <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#mean-encodings"><span class="nav-number">1.</span> <span class="nav-text">Mean encodings</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#general-tips"><span class="nav-number">1.0.1.</span> <span class="nav-text">General tips</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#read-data"><span class="nav-number">2.</span> <span class="nav-text">Read data</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#aggregate-data"><span class="nav-number">3.</span> <span class="nav-text">Aggregate data</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#mean-encodings-without-regularization"><span class="nav-number">4.</span> <span class="nav-text">Mean encodings without regularization</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#method-1"><span class="nav-number">4.0.0.1.</span> <span class="nav-text">Method 1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#method-2"><span class="nav-number">4.0.0.2.</span> <span class="nav-text">Method 2</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#kfold-scheme"><span class="nav-number">5.</span> <span class="nav-text">1. KFold scheme</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#leave-one-out-scheme"><span class="nav-number">6.</span> <span class="nav-text">2. Leave-one-out scheme</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#smoothing"><span class="nav-number">7.</span> <span class="nav-text">3. Smoothing</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#expanding-mean-scheme"><span class="nav-number">8.</span> <span class="nav-text">4. Expanding mean scheme</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#authorization-submission"><span class="nav-number">8.1.</span> <span class="nav-text">Authorization &amp; Submission</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Ruochi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">220</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">46</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zhangruochi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zhangruochi" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zrc720@gmail.com" title="E-Mail → mailto:zrc720@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.healthinformaticslab.org/" title="http:&#x2F;&#x2F;www.healthinformaticslab.org" rel="noopener" target="_blank">HILab</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.shihaizhou.com/" title="http:&#x2F;&#x2F;www.shihaizhou.com" rel="noopener" target="_blank">Rose</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/cherish_CX/" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;cherish_CX&#x2F;" rel="noopener" target="_blank">Chunxia</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ruochi Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'qW3MLcAgcX96sB6qbegeL7rP-gzGzoHsz',
      appKey     : 'GL6JvT9DgGxqYrY5Vj6bXVuv',
      placeholder: "Thank you for your reply",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'en' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
