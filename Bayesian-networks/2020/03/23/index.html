<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PingFang SC:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zhangruochi.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="How do we choose a probability distribution to model some interesting aspect of the world?">
<meta property="og:type" content="article">
<meta property="og:title" content="Bayesian networks">
<meta property="og:url" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/index.html">
<meta property="og:site_name" content="RUOCHI.AI">
<meta property="og:description" content="How do we choose a probability distribution to model some interesting aspect of the world?">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/5.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/6.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/7.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/8.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/9.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/10.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/11.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/12.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/13.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/1.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/2.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/3.png">
<meta property="og:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/4.png">
<meta property="article:published_time" content="2020-03-23T08:03:48.000Z">
<meta property="article:modified_time" content="2021-12-31T07:16:14.000Z">
<meta property="article:author" content="Ruochi Zhang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zhangruochi.com/Bayesian-networks/2020/03/23/5.png">

<link rel="canonical" href="https://zhangruochi.com/Bayesian-networks/2020/03/23/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Bayesian networks | RUOCHI.AI</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">RUOCHI.AI</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://zhangruochi.com/Bayesian-networks/2020/03/23/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruochi Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RUOCHI.AI">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Bayesian networks
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-03-23 16:03:48" itemprop="dateCreated datePublished" datetime="2020-03-23T16:03:48+08:00">2020-03-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-12-31 15:16:14" itemprop="dateModified" datetime="2021-12-31T15:16:14+08:00">2021-12-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Artificial-Intelligence/" itemprop="url" rel="index"><span itemprop="name">Artificial Intelligence</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Artificial-Intelligence/Probabilistic-Graphical-Models/" itemprop="url" rel="index"><span itemprop="name">Probabilistic Graphical Models</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/Bayesian-networks/2020/03/23/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/Bayesian-networks/2020/03/23/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <div class="post-description">How do we choose a probability distribution to model some interesting aspect of the world?</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="probabilistic-modeling-with-bayesian-networks">Probabilistic modeling with Bayesian networks</h2>
<p>Directed graphical models (a.k.a. Bayesian networks) are a family of probability distributions that admit a compact parametrization that can be naturally described using a directed graph.</p>
<p>The general idea behind this parametrization is surprisingly simple. Recall that by the chain rule, we can write any probability <span class="math inline">\(p\)</span> as:</p>
<p><span class="math display">\[
p(x_1, x_2, \dotsc, x_n) = p(x_1) p(x_2 \mid x_1) \cdots p(x_n \mid x_{n-1}, \dotsc, x_2, x_1).
\]</span></p>
<p>A <strong>compact</strong> Bayesian network is a distribution in which each factor on the right hand side depends only on a small number of <em>ancestor variables</em> <span class="math inline">\(x_{A_i}\)</span>:</p>
<p><span class="math display">\[ p(x_i \mid x_{i-1}, \dotsc, x_1) = p(x_i \mid x_{A_i}). \]</span></p>
<p>For example, in a model with five variables, we may choose to approximate the factor <span class="math inline">\(p(x_5 \mid x_4, x_3, x_2, x_1)\)</span> with <span class="math inline">\(p(x_5 \mid x_4, x_3)\)</span>. In this case, we write <span class="math inline">\(x_{A_5} = \{x_4, x_3\}\)</span>.</p>
<h2 id="graphical-representation">Graphical representation</h2>
<p>As an example, consider a model of a student's grade <span class="math display">\[g\]</span> on an exam. This grade depends on the exam's difficulty <span class="math inline">\(d\)</span> and the student's intelligence <span class="math inline">\(i\)</span>; it also affects the quality <span class="math inline">\(l\)</span> of the reference letter from the professor who taught the course. The student's intelligence <span class="math inline">\(i\)</span> affects the SAT score <span class="math inline">\(s\)</span> as well. Each variable is binary, except for <span class="math inline">\(g\)</span>, which takes 3 possible values.</p>
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="5.png" width = "70%" height="70%">
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
Bayes net model describing the performance of a student on an exam. The distribution can be represented a product of conditional probability distributions specified by tables. The form of these distributions is described by edges in the graph.
</div>
</center>
<p>The joint probability distribution over the 5 variables naturally factorizes as follows:</p>
<p><span class="math display">\[ p(l, g, i, d, s) = p(l \mid g)\, p(g \mid i, d)\, p(i)\, p(d)\, p(s \mid i). \]</span></p>
<p>The graphical representation of this distribution is a DAG that visually specifies how random variables depend on each other. The graph clearly indicates that the letter depends on the grade, which in turn depends on the student's intelligence and the difficulty of the exam.</p>
<p>Another way to interpret directed graphs is in terms of stories for how the data was generated. In the above example, to determine the quality of the reference letter, we may first sample an intelligence level and an exam difficulty; then, a student's grade is sampled given these parameters; finally, the recommendation letter is generated based on that grade.</p>
<h2 id="formal-definition.">Formal definition.</h2>
<p>Formally, a Bayesian network is a directed graph <span class="math inline">\(G = (V,E)\)</span> together with</p>
<ul>
<li>A random variable <span class="math inline">\(x_i\)</span> for each node <span class="math inline">\(i \in V\)</span>.</li>
<li>One conditional probability distribution (CPD) <span class="math inline">\(p(x_i \mid x_{A_i})\)</span> per node, specifying the probability of <span class="math inline">\(x_i\)</span> conditioned on its parents' values.</li>
</ul>
<p>Thus, a Bayesian network defines a probability distribution <span class="math inline">\(p\)</span>. Conversely, we say that a probability <span class="math inline">\(p\)</span> <strong>factorizes</strong> over a DAG <span class="math inline">\(G\)</span> if it can be decomposed into a product of factors, as specified by <span class="math inline">\(G\)</span>.</p>
<p>It is not hard to see that a probability represented by a Bayesian network will be valid: clearly, it will be non-negative and one can show using an induction argument (and using the fact that the CPDs are valid probabilities) that the sum over all variable assignments will be one. Conversely, we can also show by counter-example that when <span class="math display">\[G\]</span> contains cycles, its associated probability may not sum to one.</p>
<h2 id="the-dependencies-of-a-bayes-net">The dependencies of a Bayes net</h2>
<p>To summarize, Bayesian networks represent probability distributions that can be formed via products of smaller, local conditional probability distributions (one for each variable). By expressing a probability in this form, we are introducing into our model assumptions that certain variables are independent.</p>
<p>This raises the question: which independence assumptions are we exactly making by using a Bayesian network model with a given structure described by <span class="math inline">\(G\)</span>? This question is important for two reasons: we should know precisely what model assumptions we are making (and whether they are correct); also, this information will help us design more efficient inference algorithms later on.</p>
<p>Let us use the notation <span class="math inline">\(I(p)\)</span> to denote the set of all independencies that hold for a joint distribution <span class="math inline">\(p\)</span>. For example, if <span class="math inline">\(p(x,y) = p(x) p(y)\)</span>, then we say that <span class="math inline">\(x \perp y \in I(p)\)</span>.</p>
<h3 id="independencies-described-by-directed-graphs">Independencies described by directed graphs</h3>
<p>It turns out that a Bayesian network <span class="math inline">\(p\)</span> very elegantly describes many independencies in <span class="math inline">\(I(p)\)</span>; these independencies can be recovered from the graph by looking at three types of structures.</p>
<p>For simplicity, let's start by looking at a Bayes net <span class="math inline">\(G\)</span> with three nodes: <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span>. In this case, <span class="math display">\[G\]</span> essentially has only three possible structures, each of which leads to different independence assumptions. The interested reader can easily prove these results using a bit of algebra.</p>
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="6.png" width = "70%" height="70%">
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
Bayesian networks over three variables, encoding different types of dependencies: cascade (a,b), common parent (c), and v-structure (d).
</div>
</center>
<ul>
<li><p><strong>Common parent.</strong> If <span class="math inline">\(G\)</span> is of the form <span class="math inline">\(A \leftarrow B \rightarrow C\)</span>, and <span class="math inline">\(B\)</span> is observed, then <span class="math inline">\(A \perp C \mid B\)</span>. However, if <span class="math inline">\(B\)</span> is unobserved, then <span class="math inline">\(A \not\perp C\)</span>. Intuitively this stems from the fact that <span class="math inline">\(B\)</span> contains all the information that determines the outcomes of <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span>; once it is observed, there is nothing else that affects these variables' outcomes.</p></li>
<li><p><strong>Cascade.</strong>: If <span class="math inline">\(G\)</span> equals <span class="math inline">\(A \rightarrow B \rightarrow C\)</span>, and <span class="math inline">\(B\)</span> is again observed, then, again <span class="math inline">\(A \perp C \mid B\)</span>. However, if <span class="math inline">\(B\)</span> is unobserved, then <span class="math inline">\(A \not\perp C\)</span>. Here, the intuition is again that <span class="math inline">\(B\)</span> holds all the information that determines the outcome of <span class="math inline">\(C\)</span>; thus, it does not matter what value <span class="math inline">\(A\)</span> takes.</p></li>
<li><p><strong>V-structure.</strong> (also known as <em>explaining away</em>): If <span class="math inline">\(G\)</span> is <span class="math inline">\(A \rightarrow C \leftarrow B\)</span>, then knowing <span class="math inline">\(C\)</span> couples <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. In other words, <span class="math inline">\(A \perp B\)</span> if <span class="math inline">\(C\)</span> is unobserved, but <span class="math inline">\(A \not\perp B \mid C\)</span> if <span class="math inline">\(C\)</span> is observed.</p></li>
</ul>
<p>The latter case requires additional explanation. Suppose that <span class="math inline">\(C\)</span> is a Boolean variable that indicates whether our lawn is wet one morning; <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are two explanations for it being wet: either it rained (indicated by <span class="math inline">\(A\)</span>), or the sprinkler turned on (indicated by <span class="math inline">\(B\)</span>). If we know that the grass is wet (<span class="math inline">\(C\)</span> is true) and the sprinkler didn't go on (<span class="math inline">\(B\)</span> is false), then the probability that <span class="math inline">\(A\)</span> is true must be one, because that is the only other possible explanation. Hence, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are not independent given <span class="math inline">\(C\)</span>.</p>
<p>These structures clearly describe the independencies encoded by a three-variable Bayesian net.</p>
<h3 id="d-separation"><span class="math inline">\(d\)</span>-separation</h3>
<p>We can extend them to general networks by applying them recursively over any larger graph. This leads to a notion called <span class="math inline">\(d\)</span>-separation (where <span class="math inline">\(d\)</span> stands for directed).</p>
<p>Let <span class="math inline">\(Q\)</span>, <span class="math inline">\(W\)</span>, and <span class="math inline">\(O\)</span> be three sets of nodes in a Bayesian Network <span class="math inline">\(G\)</span>. We say that <span class="math inline">\(Q\)</span> and <span class="math inline">\(W\)</span> are <span class="math inline">\(d\)</span>-separated given <span class="math inline">\(O\)</span> (<em>i.e.</em> the variables <span class="math inline">\(O\)</span> are observed) if <span class="math inline">\(Q\)</span> and <span class="math inline">\(W\)</span> are not connected by an <em>active path</em>. An undirected path in <span class="math inline">\(G\)</span> is called <em>active</em> given observed variables <span class="math inline">\(O\)</span> if for every consecutive triple of variables <span class="math inline">\(X,Y,Z\)</span> on the path, one of the following holds:</p>
<ul>
<li><span class="math inline">\(X \leftarrow Y \leftarrow Z\)</span>, and <span class="math inline">\(Y\)</span> is unobserved <span class="math inline">\(Y \not\in O\)</span></li>
<li><span class="math inline">\(X \rightarrow Y \rightarrow Z\)</span>, and <span class="math inline">\(Y\)</span> is unobserved <span class="math inline">\(Y \not\in O\)</span></li>
<li><span class="math inline">\(X \leftarrow Y \rightarrow Z\)</span>, and <span class="math inline">\(Y\)</span> is unobserved <span class="math inline">\(Y \not\in O\)</span></li>
<li><span class="math inline">\(X \rightarrow Y \leftarrow Z\)</span>, and <span class="math inline">\(Y\)</span> or any of its descendants are observed.</li>
</ul>
<p>In other words: A trail <span class="math inline">\(X1, \cdots, X_n\)</span> is active given Z if: - for any v-structure we have that <span class="math inline">\(X_i\)</span> or one of its descendants <span class="math inline">\(\in\)</span> Z - no other <span class="math inline">\(X_i\)</span> is in Z</p>
In this example, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_6\)</span> are <span class="math inline">\(d\)</span>-separated given <span class="math inline">\(X_2, X_3\)</span>.
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="7.png" width = "70%" height="70%">
</center>
<p>However, <span class="math inline">\(X_2, X_3\)</span> are not <span class="math inline">\(d\)</span>-separated given <span class="math inline">\(X_1, X_6\)</span>. There is an active pass which passed through the V-structure created when <span class="math inline">\(X_6\)</span> is observed.</p>
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="8.png" width = "70%" height="70%">
</center>
<p>For example, in the graph below, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_6\)</span> are <span class="math inline">\(d\)</span>-separated given <span class="math inline">\(X_2, X_3\)</span>. However, <span class="math inline">\(X_2, X_3\)</span> are not <span class="math inline">\(d\)</span>-separated given <span class="math inline">\(X_1, X_6\)</span>, because we can find an active path <span class="math inline">\((X_2, X_6, X_5, X_3)\)</span></p>
<p>The notion of <span class="math inline">\(d\)</span>-separation is useful, because it lets us describe a large fraction of the dependencies that hold in our model. Let <span class="math inline">\(I(G) = \{(X \perp Y \mid Z) : \text{$X,Y$ are $d$-sep given $Z$}\}\)</span> be a set of variables that are <span class="math inline">\(d\)</span>-separated in <span class="math inline">\(G\)</span>.</p>
<h4 id="two-theorem">Two theorem</h4>
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="9.png" width = "70%" height="70%">
</center>
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="10.png" width = "70%" height="70%">
</center>
<h3 id="i-map"><span class="math inline">\(I\)</span>-map</h3>
<blockquote>
<p>If <span class="math inline">\(p\)</span> factorizes over <span class="math inline">\(G\)</span>, then <span class="math inline">\(I(G) \subseteq I(p)\)</span>. In this case, we say that <span class="math inline">\(G\)</span> is an <span class="math inline">\(I\)</span>-map (independence map) for <span class="math inline">\(p\)</span>.</p>
</blockquote>
<p>In other words, all the independencies encoded in <span class="math inline">\(G\)</span> are sound: variables that are <span class="math inline">\(d\)</span>-separated in <span class="math inline">\(G\)</span> are truly independent in <span class="math inline">\(p\)</span>. However, the converse is not true: a distribution may factorize over <span class="math inline">\(G\)</span>, yet have independencies that are not captured in <span class="math inline">\(G\)</span>.</p>
<p>In a way this is almost a trivial statement. If <span class="math inline">\(p(x,y) = p(x)p(y)\)</span>, then this distribution still factorizes over the graph <span class="math inline">\(y \rightarrow x\)</span>, since we can always write it as <span class="math inline">\(p(x,y) = p(x\mid y)p(y)\)</span> with a CPD <span class="math inline">\(p(x\mid y)\)</span> in which the probability of <span class="math inline">\(x\)</span> does not actually vary with <span class="math inline">\(y\)</span>. However, we can construct a graph that matches the structure of <span class="math inline">\(p\)</span> by simply removing that unnecessary edge.</p>
<h4 id="theorem">Theorem</h4>
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="11.png" width = "70%" height="70%">
</center>
<h2 id="summary">Summary</h2>
<p>Two equivalent views of graph structure: - <strong>Factorization</strong>: <span class="math inline">\(G\)</span> allows <span class="math inline">\(P\)</span> to be represented - <strong>I-map</strong>: Independencies encoded by G hold in P - If <span class="math inline">\(P\)</span> factorizes over a graph <span class="math inline">\(G\)</span>, we can read from the graph independencies that must hold in <span class="math inline">\(P\)</span> (an independency map)</p>
<h2 id="naive-bayes">Naive Bayes</h2>
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="12.png" width = "70%" height="70%">
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
Naive Bayes Probabilistic Graphical Model
</div>
</center>
<p>From the graph,</p>
<p><span class="math display">\[(x_i \perp x_j | c) \quad \text{for all} \quad x_i, x_j\]</span></p>
<p>Then, we can get</p>
<p><span class="math display">\[P(C, x_i, \cdots, x_n) = P(c)\prod_{i=1}^{n}P(x_i | C)\]</span></p>
<p>Therefore, the raito of two class is:</p>
<p><span class="math display">\[\frac{P(C = c^{1} | x_i, \cdots, x_n)}{P(C = c^{2} | x_i, \cdots, x_n)} = \frac{P(C = c^{1})}{P(C = c^{2})}\prod_{i=1}^{n}\frac{P(x_i | C = c^{1})}{P( x_i | C = c^{2})}\]</span></p>
<p>Indtroduce <code>Bernoulli</code>(or others) to calcute probabilities</p>
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="13.png" width = "70%" height="70%">
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
Bernoulli Naive Bayes for Text
</div>
</center>
<ul>
<li>Simple approach for classification
<ul>
<li>Computationally efficient</li>
<li>Easy to construct</li>
</ul></li>
<li>Surprisingly effective in domains with many <strong>weakly</strong> relevant features</li>
<li>Strong independence assumptions reduce performance when many features are strongly correlated</li>
</ul>
<h2 id="questions">Questions</h2>
<h4 id="calculate-the-number-of-parameters-of-a-distribution-model">Calculate the number of parameters of a distribution model</h4>
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="1.png" width = "100%" height="100%">
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
The number of parameters
</div>
</center>
<h4 id="inter-causal-reasoning">Inter-causal reasoning</h4>
<center>
<img style="border-radius: 0.1em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="2.png" width = "100%" height="100%"> <img style="border-radius: 0.1em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="3.png" width = "100%" height="100%">
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
Inter-causal reasoning
</div>
</center>
<h4 id="independencies-in-a-graph">Independencies in a graph</h4>
<center>
<img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="4.png" width = "100%" height="100%">
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
Independencies in a graph
</div>
</center>
<h2 id="reference">Reference</h2>
<ul>
<li>https://ermongroup.github.io/cs228-notes/</li>
<li>Course note from Coursera course <a target="_blank" rel="noopener" href="https://www.coursera.org/learn/probabilistic-graphical-models/">Probabilistic graphical models</a> lectured by Daphne Koller</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/Fucking-distributions/2020/03/22/" rel="prev" title="Fucking distributions">
      <i class="fa fa-chevron-left"></i> Fucking distributions
    </a></div>
      <div class="post-nav-item">
    <a href="/Deploy-Models-with-TensorFlow-Serving-and-Flask/2020/04/03/" rel="next" title="Deploy Models with TensorFlow Serving and Flask">
      Deploy Models with TensorFlow Serving and Flask <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#probabilistic-modeling-with-bayesian-networks"><span class="nav-number">1.</span> <span class="nav-text">Probabilistic modeling with Bayesian networks</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#graphical-representation"><span class="nav-number">2.</span> <span class="nav-text">Graphical representation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#formal-definition."><span class="nav-number">3.</span> <span class="nav-text">Formal definition.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#the-dependencies-of-a-bayes-net"><span class="nav-number">4.</span> <span class="nav-text">The dependencies of a Bayes net</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#independencies-described-by-directed-graphs"><span class="nav-number">4.1.</span> <span class="nav-text">Independencies described by directed graphs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#d-separation"><span class="nav-number">4.2.</span> <span class="nav-text">\(d\)-separation</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#two-theorem"><span class="nav-number">4.2.1.</span> <span class="nav-text">Two theorem</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#i-map"><span class="nav-number">4.3.</span> <span class="nav-text">\(I\)-map</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#theorem"><span class="nav-number">4.3.1.</span> <span class="nav-text">Theorem</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#summary"><span class="nav-number">5.</span> <span class="nav-text">Summary</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#naive-bayes"><span class="nav-number">6.</span> <span class="nav-text">Naive Bayes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#questions"><span class="nav-number">7.</span> <span class="nav-text">Questions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#calculate-the-number-of-parameters-of-a-distribution-model"><span class="nav-number">7.0.1.</span> <span class="nav-text">Calculate the number of parameters of a distribution model</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#inter-causal-reasoning"><span class="nav-number">7.0.2.</span> <span class="nav-text">Inter-causal reasoning</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#independencies-in-a-graph"><span class="nav-number">7.0.3.</span> <span class="nav-text">Independencies in a graph</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reference"><span class="nav-number">8.</span> <span class="nav-text">Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Ruochi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">215</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">45</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zhangruochi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zhangruochi" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zrc720@gmail.com" title="E-Mail → mailto:zrc720@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.healthinformaticslab.org/" title="http:&#x2F;&#x2F;www.healthinformaticslab.org" rel="noopener" target="_blank">HILab</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.shihaizhou.com/" title="http:&#x2F;&#x2F;www.shihaizhou.com" rel="noopener" target="_blank">Rose</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/cherish_CX/" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;cherish_CX&#x2F;" rel="noopener" target="_blank">Chunxia</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ruochi Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'qW3MLcAgcX96sB6qbegeL7rP-gzGzoHsz',
      appKey     : 'GL6JvT9DgGxqYrY5Vj6bXVuv',
      placeholder: "Thank you for your reply",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'en' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
