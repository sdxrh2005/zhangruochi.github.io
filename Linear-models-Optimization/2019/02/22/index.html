<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PingFang SC:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zhangruochi.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="This is the course assignment of Coursera Specialization [Advance Machine Learning](https:&#x2F;&#x2F;www.coursera.org&#x2F;specializations&#x2F;aml)">
<meta property="og:type" content="article">
<meta property="og:title" content="Linear models, Optimization">
<meta property="og:url" content="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/index.html">
<meta property="og:site_name" content="RUOCHI.AI">
<meta property="og:description" content="This is the course assignment of Coursera Specialization [Advance Machine Learning](https:&#x2F;&#x2F;www.coursera.org&#x2F;specializations&#x2F;aml)">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/output_5_0.png">
<meta property="og:image" content="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/kernel.png">
<meta property="og:image" content="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/output_30_0.png">
<meta property="og:image" content="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/output_33_0.png">
<meta property="og:image" content="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/sgd.png">
<meta property="og:image" content="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/output_38_0.png">
<meta property="og:image" content="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/output_43_0.png">
<meta property="article:published_time" content="2019-02-21T20:06:40.000Z">
<meta property="article:modified_time" content="2020-01-20T13:07:27.834Z">
<meta property="article:author" content="Ruochi Zhang">
<meta property="article:tag" content="Project">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/output_5_0.png">

<link rel="canonical" href="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Linear models, Optimization | RUOCHI.AI</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">RUOCHI.AI</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>About</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://zhangruochi.com/Linear-models-Optimization/2019/02/22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruochi Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RUOCHI.AI">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Linear models, Optimization
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-02-22 04:06:40" itemprop="dateCreated datePublished" datetime="2019-02-22T04:06:40+08:00">2019-02-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-01-20 21:07:27" itemprop="dateModified" datetime="2020-01-20T21:07:27+08:00">2020-01-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Artificial-Intelligence/" itemprop="url" rel="index"><span itemprop="name">Artificial Intelligence</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Artificial-Intelligence/Deep-Learning/" itemprop="url" rel="index"><span itemprop="name">Deep Learning</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/Linear-models-Optimization/2019/02/22/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/Linear-models-Optimization/2019/02/22/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <div class="post-description">This is the course assignment of Coursera Specialization [Advance Machine Learning](https://www.coursera.org/specializations/aml)</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="programming-assignment-linear-models-optimization">Programming assignment (Linear models, Optimization)</h1>
<p>In this programming assignment you will implement a linear classifier and train it using stochastic gradient descent modifications and numpy.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">&quot;..&quot;</span>)</span><br><span class="line"><span class="keyword">import</span> grading</span><br><span class="line">grader = grading.Grader(assignment_key=<span class="string">&quot;UaHtvpEFEee0XQ6wjK-hZg&quot;</span>, </span><br><span class="line">                      all_parts=[<span class="string">&quot;xU7U4&quot;</span>, <span class="string">&quot;HyTF6&quot;</span>, <span class="string">&quot;uNidL&quot;</span>, <span class="string">&quot;ToK7N&quot;</span>, <span class="string">&quot;GBdgZ&quot;</span>, <span class="string">&quot;dLdHG&quot;</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># token expires every 30 min</span></span><br><span class="line">COURSERA_TOKEN = <span class="string">&quot;TmANlFkR4a4doLvg&quot;</span></span><br><span class="line">COURSERA_EMAIL = <span class="string">&quot;lvduzhen@gmail.com&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="two-dimensional-classification">Two-dimensional classification</h2>
<p>To make things more intuitive, let's solve a 2D classification problem with synthetic data.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;train.npy&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fin:</span><br><span class="line">    X = np.load(fin)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;target.npy&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fin:</span><br><span class="line">    y = np.load(fin)</span><br><span class="line"></span><br><span class="line">plt.scatter(X[:, <span class="number">0</span>], X[:, <span class="number">1</span>], c=y, cmap=plt.cm.Paired, s=<span class="number">20</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<figure>
<img src="output_5_0.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<h1 id="task">Task</h1>
<h2 id="features">Features</h2>
<p>As you can notice the data above isn't linearly separable. Since that we should add features (or use non-linear model). Note that decision line between two classes have form of circle, since that we can add quadratic features to make the problem linearly separable. The idea under this displayed on image below:</p>
<p><img src="kernel.png" /></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(X)</span><br></pre></td></tr></table></figure>
<pre><code>[[ 1.20798057  0.0844994 ]
 [ 0.76121787  0.72510869]
 [ 0.55256189  0.51937292]
 ..., 
 [-1.22224754  0.45743421]
 [ 0.43973452 -1.47275142]
 [ 1.4928118   1.15683375]]</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">expand</span>(<span class="params">X</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Adds quadratic features. </span></span><br><span class="line"><span class="string">    This expansion allows your linear model to make non-linear separation.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    For each sample (row in matrix), compute an expanded row:</span></span><br><span class="line"><span class="string">    [feature0, feature1, feature0^2, feature1^2, feature0*feature1, 1]</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    :param X: matrix of features, shape [n_samples,2]</span></span><br><span class="line"><span class="string">    :returns: expanded features of shape [n_samples,6]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    X_expanded = np.zeros((X.shape[<span class="number">0</span>], <span class="number">6</span>))</span><br><span class="line">    X_expanded[:,<span class="number">0</span>] = X[:,<span class="number">0</span>]</span><br><span class="line">    X_expanded[:,<span class="number">1</span>] = X[:,<span class="number">1</span>]</span><br><span class="line">    X_expanded[:,<span class="number">2</span>] = np.square(X[:,<span class="number">0</span>])</span><br><span class="line">    X_expanded[:,<span class="number">3</span>] = np.square(X[:,<span class="number">1</span>])</span><br><span class="line">    X_expanded[:,<span class="number">4</span>] = X[:,<span class="number">0</span>] * X[:,<span class="number">1</span>]</span><br><span class="line">    X_expanded[:,<span class="number">5</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> X_expanded</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># <span class="doctag">TODO:</span>&lt;your code here&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X_expanded = expand(X)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X_expanded</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 1.20798057,  0.0844994 ,  1.45921706,  0.00714015,  0.10207364,
         1.        ],
       [ 0.76121787,  0.72510869,  0.57945265,  0.52578261,  0.5519657 ,
         1.        ],
       [ 0.55256189,  0.51937292,  0.30532464,  0.26974823,  0.28698568,
         1.        ],
       ..., 
       [-1.22224754,  0.45743421,  1.49388906,  0.20924606, -0.55909785,
         1.        ],
       [ 0.43973452, -1.47275142,  0.19336645,  2.16899674, -0.64761963,
         1.        ],
       [ 1.4928118 ,  1.15683375,  2.22848708,  1.33826433,  1.72693508,
         1.        ]])</code></pre>
<p>Here are some tests for your implementation of <code>expand</code> function.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># simple test on random numbers</span></span><br><span class="line"></span><br><span class="line">dummy_X = np.array([</span><br><span class="line">        [<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">        [<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">        [<span class="number">2.61</span>,-<span class="number">1.28</span>],</span><br><span class="line">        [-<span class="number">0.59</span>,<span class="number">2.1</span>]</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"><span class="comment"># call your expand function</span></span><br><span class="line">dummy_expanded = expand(dummy_X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># what it should have returned:   x0       x1       x0^2     x1^2     x0*x1    1</span></span><br><span class="line">dummy_expanded_ans = np.array([[ <span class="number">0.</span>    ,  <span class="number">0.</span>    ,  <span class="number">0.</span>    ,  <span class="number">0.</span>    ,  <span class="number">0.</span>    ,  <span class="number">1.</span>    ],</span><br><span class="line">                               [ <span class="number">1.</span>    ,  <span class="number">0.</span>    ,  <span class="number">1.</span>    ,  <span class="number">0.</span>    ,  <span class="number">0.</span>    ,  <span class="number">1.</span>    ],</span><br><span class="line">                               [ <span class="number">2.61</span>  , -<span class="number">1.28</span>  ,  <span class="number">6.8121</span>,  <span class="number">1.6384</span>, -<span class="number">3.3408</span>,  <span class="number">1.</span>    ],</span><br><span class="line">                               [-<span class="number">0.59</span>  ,  <span class="number">2.1</span>   ,  <span class="number">0.3481</span>,  <span class="number">4.41</span>  , -<span class="number">1.239</span> ,  <span class="number">1.</span>    ]])</span><br><span class="line"></span><br><span class="line"><span class="comment">#tests</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">isinstance</span>(dummy_expanded,np.ndarray), <span class="string">&quot;please make sure you return numpy array&quot;</span></span><br><span class="line"><span class="keyword">assert</span> dummy_expanded.shape == dummy_expanded_ans.shape, <span class="string">&quot;please make sure your shape is correct&quot;</span></span><br><span class="line"><span class="keyword">assert</span> np.allclose(dummy_expanded,dummy_expanded_ans,<span class="number">1e-3</span>), <span class="string">&quot;Something&#x27;s out of order with features&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Seems legit!&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>Seems legit!</code></pre>
<h2 id="logistic-regression">Logistic regression</h2>
<p>To classify objects we will obtain probability of object belongs to class '1'. To predict probability we will use output of linear model and logistic function:</p>
<p><span class="math display">\[ a(x; w) = \langle w, x \rangle \]</span> <span class="math display">\[ P( y=1 \; \big| \; x, \, w) = \dfrac{1}{1 + \exp(- \langle w, x \rangle)} = \sigma(\langle w, x \rangle)\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">probability</span>(<span class="params">X, w</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Given input features and weights</span></span><br><span class="line"><span class="string">    return predicted probabilities of y==1 given x, P(y=1|x), see description above</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    Don&#x27;t forget to use expand(X) function (where necessary) in this and subsequent functions.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    :param X: feature matrix X of shape [n_samples,6] (expanded)</span></span><br><span class="line"><span class="string">    :param w: weight vector w of shape [6] for each of the expanded features</span></span><br><span class="line"><span class="string">    :returns: an array of predicted probabilities in [0,1] interval.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    w = w.reshape((w.shape[<span class="number">0</span>],<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span>  <span class="number">1</span>/(<span class="number">1</span> + np.exp(-np.dot(X,w)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># <span class="doctag">TODO:</span>&lt;your code here&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dummy_weights = np.linspace(-<span class="number">1</span>, <span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">ans_part1 = probability(X_expanded[:<span class="number">1</span>, :], dummy_weights)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## GRADED PART, DO NOT CHANGE!</span></span><br><span class="line">grader.set_answer(<span class="string">&quot;xU7U4&quot;</span>, ans_part1)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># you can make submission with answers so far to check yourself at this stage</span></span><br><span class="line">grader.submit(COURSERA_EMAIL, COURSERA_TOKEN)</span><br></pre></td></tr></table></figure>
<pre><code>Submitted to Coursera platform. See results on assignment page!</code></pre>
<p>In logistic regression the optimal parameters <span class="math inline">\(w\)</span> are found by cross-entropy minimization:</p>
<p>Loss for one sample: <span class="math display">\[ l(x_i, y_i, w) = - \left[ {y_i \cdot log P(y_i = 1 \, | \, x_i,w) + (1-y_i) \cdot log (1-P(y_i = 1\, | \, x_i,w))}\right] \]</span></p>
<p>Loss for many samples: <span class="math display">\[ L(X, \vec{y}, w) =  {1 \over \ell} \sum_{i=1}^\ell l(x_i, y_i, w) \]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_loss</span>(<span class="params">X, y, w</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Given feature matrix X [n_samples,6], target vector [n_samples] of 1/0,</span></span><br><span class="line"><span class="string">    and weight vector w [6], compute scalar loss function L using formula above.</span></span><br><span class="line"><span class="string">    Keep in mind that our loss is averaged over all samples (rows) in X.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    y = y.reshape((y.shape[<span class="number">0</span>],<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> -np.mean(y*np.log(probability(X,w)) + (<span class="number">1</span>-y)*np.log(<span class="number">1</span>-probability(X,w)))</span><br><span class="line">    <span class="comment"># <span class="doctag">TODO:</span>&lt;your code here&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># use output of this cell to fill answer field </span></span><br><span class="line">ans_part2 = compute_loss(X_expanded, y, dummy_weights)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## GRADED PART, DO NOT CHANGE!</span></span><br><span class="line">grader.set_answer(<span class="string">&quot;HyTF6&quot;</span>, ans_part2)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># you can make submission with answers so far to check yourself at this stage</span></span><br><span class="line">grader.submit(COURSERA_EMAIL, COURSERA_TOKEN)</span><br></pre></td></tr></table></figure>
<pre><code>Submitted to Coursera platform. See results on assignment page!</code></pre>
<p>Since we train our model with gradient descent, we should compute gradients.</p>
<p>To be specific, we need a derivative of loss function over each weight [6 of them].</p>
<p><span class="math display">\[ \nabla_w L = {1 \over \ell} \sum_{i=1}^\ell \nabla_w l(x_i, y_i, w) \]</span></p>
<p>We won't be giving you the exact formula this time — instead, try figuring out a derivative with pen and paper.</p>
<p>As usual, we've made a small test for you, but if you need more, feel free to check your math against finite differences (estimate how <span class="math inline">\(L\)</span> changes if you shift <span class="math inline">\(w\)</span> by <span class="math inline">\(10^{-5}\)</span> or so).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_grad</span>(<span class="params">X, y, w</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Given feature matrix X [n_samples,6], target vector [n_samples] of 1/0,</span></span><br><span class="line"><span class="string">    and weight vector w [6], compute vector [6] of derivatives of L over each weights.</span></span><br><span class="line"><span class="string">    Keep in mind that our loss is averaged over all samples (rows) in X.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    y = y.reshape((y.shape[<span class="number">0</span>],<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> np.mean(X*(probability(X,w) - y),axis = <span class="number">0</span>)</span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># use output of this cell to fill answer field </span></span><br><span class="line">ans_part3 = np.linalg.norm(compute_grad(X_expanded, y, dummy_weights))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## GRADED PART, DO NOT CHANGE!</span></span><br><span class="line">grader.set_answer(<span class="string">&quot;uNidL&quot;</span>, ans_part3)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># you can make submission with answers so far to check yourself at this stage</span></span><br><span class="line">grader.submit(COURSERA_EMAIL, COURSERA_TOKEN)</span><br></pre></td></tr></table></figure>
<pre><code>Submitted to Coursera platform. See results on assignment page!</code></pre>
<p>Here's an auxiliary function that visualizes the predictions:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> IPython <span class="keyword">import</span> display</span><br><span class="line"></span><br><span class="line">h = <span class="number">0.01</span></span><br><span class="line">x_min, x_max = X[:, <span class="number">0</span>].<span class="built_in">min</span>() - <span class="number">1</span>, X[:, <span class="number">0</span>].<span class="built_in">max</span>() + <span class="number">1</span></span><br><span class="line">y_min, y_max = X[:, <span class="number">1</span>].<span class="built_in">min</span>() - <span class="number">1</span>, X[:, <span class="number">1</span>].<span class="built_in">max</span>() + <span class="number">1</span></span><br><span class="line">xx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">visualize</span>(<span class="params">X, y, w, history</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;draws classifier prediction with matplotlib magic&quot;&quot;&quot;</span></span><br><span class="line">    Z = probability(expand(np.c_[xx.ravel(), yy.ravel()]), w)</span><br><span class="line">    Z = Z.reshape(xx.shape)</span><br><span class="line">    plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">    plt.contourf(xx, yy, Z, alpha=<span class="number">0.8</span>)</span><br><span class="line">    plt.scatter(X[:, <span class="number">0</span>], X[:, <span class="number">1</span>], c=y, cmap=plt.cm.Paired)</span><br><span class="line">    plt.xlim(xx.<span class="built_in">min</span>(), xx.<span class="built_in">max</span>())</span><br><span class="line">    plt.ylim(yy.<span class="built_in">min</span>(), yy.<span class="built_in">max</span>())</span><br><span class="line">    </span><br><span class="line">    plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">    plt.plot(history)</span><br><span class="line">    plt.grid()</span><br><span class="line">    ymin, ymax = plt.ylim()</span><br><span class="line">    plt.ylim(<span class="number">0</span>, ymax)</span><br><span class="line">    display.clear_output(wait=<span class="literal">True</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">visualize(X, y, dummy_weights, [<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.25</span>])</span><br></pre></td></tr></table></figure>
<figure>
<img src="output_30_0.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<h2 id="training">Training</h2>
<p>In this section we'll use the functions you wrote to train our classifier using stochastic gradient descent.</p>
<p>You can try change hyperparameters like batch size, learning rate and so on to find the best one, but use our hyperparameters when fill answers.</p>
<h2 id="mini-batch-sgd">Mini-batch SGD</h2>
<p>Stochastic gradient descent just takes a random batch of <span class="math inline">\(m\)</span> samples on each iteration, calculates a gradient of the loss on it and makes a step: <span class="math display">\[ w_t = w_{t-1} - \eta \dfrac{1}{m} \sum_{j=1}^m \nabla_w l(x_{i_j}, y_{i_j}, w_t) \]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># please use np.random.seed(42), eta=0.1, n_iter=100 and batch_size=4 for deterministic results</span></span><br><span class="line"></span><br><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line">w = np.array([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">eta= <span class="number">0.1</span> <span class="comment"># learning rate</span></span><br><span class="line"></span><br><span class="line">n_iter = <span class="number">100</span></span><br><span class="line">batch_size = <span class="number">4</span></span><br><span class="line">loss = np.zeros(n_iter)</span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n_iter):</span><br><span class="line">    ind = np.random.choice(X_expanded.shape[<span class="number">0</span>], batch_size)</span><br><span class="line">    loss[i] = compute_loss(X_expanded, y, w)</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">        visualize(X_expanded[ind, :], y[ind], w, loss)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Keep in mind that compute_grad already does averaging over batch for you!</span></span><br><span class="line">    <span class="comment"># <span class="doctag">TODO:</span>&lt;your code here&gt;</span></span><br><span class="line">    random_index = np.random.randint(<span class="number">0</span>,X_expanded.shape[<span class="number">0</span>],batch_size)</span><br><span class="line">    w = w - eta * compute_grad(X_expanded[random_index,:],y[random_index],w)</span><br><span class="line"></span><br><span class="line">visualize(X, y, w, loss)</span><br><span class="line">plt.clf()</span><br></pre></td></tr></table></figure>
<figure>
<img src="output_33_0.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<pre><code>&lt;matplotlib.figure.Figure at 0x7fdbbfafb908&gt;</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># use output of this cell to fill answer field </span></span><br><span class="line">ans_part4 = compute_loss(X_expanded, y, w)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## GRADED PART, DO NOT CHANGE!</span></span><br><span class="line">grader.set_answer(<span class="string">&quot;ToK7N&quot;</span>, ans_part4)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># you can make submission with answers so far to check yourself at this stage</span></span><br><span class="line">grader.submit(COURSERA_EMAIL, COURSERA_TOKEN)</span><br></pre></td></tr></table></figure>
<pre><code>Submitted to Coursera platform. See results on assignment page!</code></pre>
<h2 id="sgd-with-momentum">SGD with momentum</h2>
<p>Momentum is a method that helps accelerate SGD in the relevant direction and dampens oscillations as can be seen in image below. It does this by adding a fraction <span class="math inline">\(\alpha\)</span> of the update vector of the past time step to the current update vector. <br> <br></p>
<p><span class="math display">\[ \nu_t = \alpha \nu_{t-1} + \eta\dfrac{1}{m} \sum_{j=1}^m \nabla_w l(x_{i_j}, y_{i_j}, w_t) \]</span> <span class="math display">\[ w_t = w_{t-1} - \nu_t\]</span></p>
<p><br></p>
<p><img src="sgd.png" /></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># please use np.random.seed(42), eta=0.05, alpha=0.9, n_iter=100 and batch_size=4 for deterministic results</span></span><br><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line">w = np.array([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">eta = <span class="number">0.05</span> <span class="comment"># learning rate</span></span><br><span class="line">alpha = <span class="number">0.9</span> <span class="comment"># momentum</span></span><br><span class="line">nu = np.zeros_like(w)</span><br><span class="line"></span><br><span class="line">n_iter = <span class="number">100</span></span><br><span class="line">batch_size = <span class="number">4</span></span><br><span class="line">loss = np.zeros(n_iter)</span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n_iter):</span><br><span class="line">    ind = np.random.choice(X_expanded.shape[<span class="number">0</span>], batch_size)</span><br><span class="line">    loss[i] = compute_loss(X_expanded, y, w)</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">        visualize(X_expanded[ind, :], y[ind], w, loss)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># <span class="doctag">TODO:</span>&lt;your code here&gt;</span></span><br><span class="line">    random_index = np.random.randint(<span class="number">0</span>,X_expanded.shape[<span class="number">0</span>],batch_size)</span><br><span class="line">    nu = alpha*nu + eta * compute_grad(X_expanded[random_index,:],y[random_index],w)</span><br><span class="line">    w = w - nu</span><br><span class="line"></span><br><span class="line">visualize(X, y, w, loss)</span><br><span class="line">plt.clf()</span><br></pre></td></tr></table></figure>
<figure>
<img src="output_38_0.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<pre><code>&lt;matplotlib.figure.Figure at 0x7fdbba216e10&gt;</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># use output of this cell to fill answer field </span></span><br><span class="line"></span><br><span class="line">ans_part5 = compute_loss(X_expanded, y, w)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## GRADED PART, DO NOT CHANGE!</span></span><br><span class="line">grader.set_answer(<span class="string">&quot;GBdgZ&quot;</span>, ans_part5)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># you can make submission with answers so far to check yourself at this stage</span></span><br><span class="line">grader.submit(COURSERA_EMAIL, COURSERA_TOKEN)</span><br></pre></td></tr></table></figure>
<pre><code>Submitted to Coursera platform. See results on assignment page!</code></pre>
<h2 id="rmsprop">RMSprop</h2>
<p>Implement RMSPROP algorithm, which use squared gradients to adjust learning rate:</p>
<p><span class="math display">\[ G_j^t = \alpha G_j^{t-1} + (1 - \alpha) g_{tj}^2 \]</span> <span class="math display">\[ w_j^t = w_j^{t-1} - \dfrac{\eta}{\sqrt{G_j^t + \varepsilon}} g_{tj} \]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># please use np.random.seed(42), eta=0.1, alpha=0.9, n_iter=100 and batch_size=4 for deterministic results</span></span><br><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line">w = np.array([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1.</span>])</span><br><span class="line"></span><br><span class="line">eta = <span class="number">0.1</span> <span class="comment"># learning rate</span></span><br><span class="line">alpha = <span class="number">0.9</span> <span class="comment"># moving average of gradient norm squared</span></span><br><span class="line">g2 = <span class="literal">None</span> <span class="comment"># we start with None so that you can update this value correctly on the first iteration</span></span><br><span class="line">eps = <span class="number">1e-8</span></span><br><span class="line">G = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">n_iter = <span class="number">100</span></span><br><span class="line">batch_size = <span class="number">4</span></span><br><span class="line">loss = np.zeros(n_iter)</span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">5</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n_iter):</span><br><span class="line">    ind = np.random.choice(X_expanded.shape[<span class="number">0</span>], batch_size)</span><br><span class="line">    loss[i] = compute_loss(X_expanded, y, w)</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">        visualize(X_expanded[ind, :], y[ind], w, loss)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># <span class="doctag">TODO:</span>&lt;your code here&gt;</span></span><br><span class="line">    random_index = np.random.randint(<span class="number">0</span>,X_expanded.shape[<span class="number">0</span>],batch_size)</span><br><span class="line">    g2 = np.square(compute_grad(X_expanded[random_index,:],y[random_index],w))</span><br><span class="line">    G = alpha*G + (<span class="number">1</span>-alpha) * g2</span><br><span class="line">    w = w - eta/np.sqrt(G + eps) * g2</span><br><span class="line">    </span><br><span class="line">visualize(X, y, w, loss)</span><br><span class="line">plt.clf()</span><br></pre></td></tr></table></figure>
<figure>
<img src="output_43_0.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<pre><code>&lt;matplotlib.figure.Figure at 0x7fdbba944f98&gt;</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># use output of this cell to fill answer field </span></span><br><span class="line">ans_part6 = compute_loss(X_expanded, y, w)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## GRADED PART, DO NOT CHANGE!</span></span><br><span class="line">grader.set_answer(<span class="string">&quot;dLdHG&quot;</span>, ans_part6)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grader.submit(COURSERA_EMAIL, COURSERA_TOKEN)</span><br></pre></td></tr></table></figure>
<pre><code>Submitted to Coursera platform. See results on assignment page!</code></pre>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Project/" rel="tag"># Project</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/INFSCI-2160-DATA-MINING-PART-ONE/2019/02/18/" rel="prev" title="INFSCI 2160 DATA MINING(PART ONE)">
      <i class="fa fa-chevron-left"></i> INFSCI 2160 DATA MINING(PART ONE)
    </a></div>
      <div class="post-nav-item">
    <a href="/An-overview-of-gradient-descent-optimization-algorithms/2019/02/23/" rel="next" title="An overview of gradient descent optimization algorithms">
      An overview of gradient descent optimization algorithms <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#programming-assignment-linear-models-optimization"><span class="nav-number">1.</span> <span class="nav-text">Programming assignment (Linear models, Optimization)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#two-dimensional-classification"><span class="nav-number">1.1.</span> <span class="nav-text">Two-dimensional classification</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#task"><span class="nav-number">2.</span> <span class="nav-text">Task</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#features"><span class="nav-number">2.1.</span> <span class="nav-text">Features</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#logistic-regression"><span class="nav-number">2.2.</span> <span class="nav-text">Logistic regression</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#training"><span class="nav-number">2.3.</span> <span class="nav-text">Training</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mini-batch-sgd"><span class="nav-number">2.4.</span> <span class="nav-text">Mini-batch SGD</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sgd-with-momentum"><span class="nav-number">2.5.</span> <span class="nav-text">SGD with momentum</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rmsprop"><span class="nav-number">2.6.</span> <span class="nav-text">RMSprop</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Ruochi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">163</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zhangruochi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zhangruochi" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zrc720@gmail.com" title="E-Mail → mailto:zrc720@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.healthinformaticslab.org/" title="http:&#x2F;&#x2F;www.healthinformaticslab.org" rel="noopener" target="_blank">HILab</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.shihaizhou.com/" title="http:&#x2F;&#x2F;www.shihaizhou.com" rel="noopener" target="_blank">Rose</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/cherish_CX/" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;cherish_CX&#x2F;" rel="noopener" target="_blank">Chunxia</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ruochi Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'qW3MLcAgcX96sB6qbegeL7rP-gzGzoHsz',
      appKey     : 'GL6JvT9DgGxqYrY5Vj6bXVuv',
      placeholder: "Thank you for your reply",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'en' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
